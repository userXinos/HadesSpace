import{d as E,g as P,i as U,j as R,S as w,k as H,r as V,o as q,c as $,h as u,e as n,f as l,t as v,u as o,H as z,w as G,m as K,M as X,l as I,n as f,I as h,p as Z,q as F,_ as J}from"./index-Ed47Sfbl.js";import{c as Q}from"./compendiumTechList-B9jRMsXf.js";import{s as W}from"./sec2str-BJg8h9CG.js";import{m as M,g as Y}from"./ModulePage.vue_vue_type_script_setup_true_lang-B04Sk9GC.js";import{C as ee}from"./CompendiumPage-2yuptFaD.js";import{T as ae}from"./TechList-BSQawgwa.js";import{N as te}from"./NumberPicker-BiE8_vzG.js";import{g as le}from"./globals-rLCyQm-J.js";import{s as _}from"./capital_ships-DSYV2UWb.js";import{a as se}from"./alliance_levels-B_mmXvbC.js";import{s as S}from"./spacebuildings-iMzfIrfg.js";import"./Data-dTk45p5x.js";import"./Page-BNtOqnGE.js";import"./byTypes-DiOuyN-I.js";const ne=i=>(Z("data-v-7d1c0111"),i=i(),F(),i),oe={class:"container"},ie={class:"modal"},re={class:"title"},ce=ne(()=>l("div",null,null,-1)),me={class:"level-picker"},de=E({__name:"CompendiumTech",setup(i){const g={RedStarScanner:S.RedStarScanner,ShipmentRelay:S.ShipmentRelay},L={Transport:_.Transport,Miner:_.Miner,Battleship:_.Battleship},{MaxModuleLevel:T}=le,b=Object.fromEntries([...Object.entries(g).map(([e,a])=>[e,a.Cost.length]),...Object.entries(L).map(([e,a])=>[e,a.BuildCost.length]),...Object.keys(M).map(e=>[e,T]),["AllianceLevel",se.XPRequired.length]]),k=Object.fromEntries([...Object.keys(g).map(e=>[e,0]),...Object.keys(L).map(e=>[e,0]),...Object.entries(M).map(([e,a])=>[e,Y(a)]),["AllianceLevel",0]]),{data:s,levelMap:y,setTechLevel:C}=Q(),{t:d}=P(),O=d("HS_COMPENDIUM"),r=U(!1),t=R({size:w.SMALL,title:d("TECHNOLOGIES"),data:{value:{},maxLevel:0,minLevel:0,lastAgoUpdate:0,get key(){return this.value.Name}}}),D=setInterval(p,5e3);H(()=>{clearTimeout(D)});function x(e){s.value&&(t.data.value=e,t.data.maxLevel=b[e.Name],t.data.minLevel=k[e.Name],r.value=!0,p())}function N(e){var a;return!((a=c(e))!=null&&a.level)}function B(e){const a=I(t.data.key);return s.value[a]||(s.value[a]={level:0}),t.data.minLevel!=0&&e==t.data.minLevel&&s.value[a].level!=0&&(e=0),s.value[a].level!=e&&(s.value[a].level=e,C(a,e),p()),e}function c(e){var a;return((a=s.value)==null?void 0:a[I(e)])||null}function j(){var a;const e=t.data.value;if(e.Icon)return f(h,{name:e.Icon,dir:e.specialIcon?"icons":"game/Modules"});if(e.Model)return f(h,{name:e.Model[((a=c(e.Name))==null?void 0:a.level)-1||5],dir:"game/Ships"});if(e.PrefabModel)return f(h,{name:e.PrefabModel,dir:"game/SpaceBuildings"})}function p(){var e;if(r.value){const a=(e=c(t.data.key))==null?void 0:e.ts;a&&(t.data.lastAgoUpdate=(new Date().getTime()-a)/1e3)}}return(e,a)=>{const A=V("t");return q(),$(ee,null,{default:u(()=>[n(o(z),null,{default:u(()=>[l("title",null,v(o(O)),1)]),_:1}),l("div",null,[l("div",oe,[n(ae,{"on-click":x,"is-muted":N,"level-map":o(y)},null,8,["level-map"])]),n(X,K({open:r.value,"onUpdate:open":a[0]||(a[0]=m=>r.value=m)},t),{body:u(()=>{var m;return[l("div",ie,[l("div",re,[l("div",null,[l("h2",null,v(e.$t(t.data.value.TID)),1),l("p",null,v(o(d)("TID_SOCIAL_TIMESTAMP",[o(W)(t.data.lastAgoUpdate)])),1),ce]),n(j)]),G(l("span",null,null,512),[[A,"CURRENT_LVL"]]),l("div",me,[n(te,{value:((m=c(t.data.key))==null?void 0:m.level)||0,min:t.data.minLevel,max:t.data.maxLevel,"onUpdate:value":B},null,8,["value","min","max"])])])]}),_:1},16,["open"])])]),_:1})}}}),ye=J(de,[["__scopeId","data-v-7d1c0111"]]);export{ye as default};
