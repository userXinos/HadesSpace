import{d as $,g as q,i as O,j as S,a as f,k as F,c as K,h as u,S as D,l as C,r as X,o as Z,e as o,f as n,u as r,H as J,t as g,M as k,m as y,w as N,n as Q,p as W,q as L,I,_ as Y}from"./index-BQAYSRgz.js";import{c as ee}from"./compendiumTechList-DA7PWyUi.js";import{s as ae}from"./sec2str-At1lDWNo.js";import{m as E,g as te,t as ne}from"./ModulePage.vue_vue_type_script_setup_true_lang-uclEdpQl.js";import{C as le}from"./CompendiumPage-C7enGGNA.js";import{T as oe}from"./TechList-Bu-vVpx2.js";import{N as se}from"./NumberPicker-BeiQOVmp.js";import{V as ie}from"./Data-BTvTm2ex.js";import{g as re}from"./globals-D0lvPSen.js";import{s as M}from"./capital_ships-BOrq68-Q.js";import{a as de}from"./alliance_levels-B_mmXvbC.js";import{s as x}from"./spacebuildings-CVaBZ2bu.js";import"./Page-ZogcQ3AW.js";import"./byTypes-DiOuyN-I.js";const me={class:"container"},ce={class:"modal"},ue={class:"title"},pe={class:"level-picker"},ve=$({__name:"CompendiumTech",setup(fe){const _={RedStarScanner:x.RedStarScanner,ShipmentRelay:x.ShipmentRelay},T={Transport:M.Transport,Miner:M.Miner,Battleship:M.Battleship},{MaxModuleLevel:B}=re,P=Object.fromEntries([...Object.entries(_).map(([e,a])=>[e,a.Cost.length]),...Object.entries(T).map(([e,a])=>[e,a.BuildCost.length]),...Object.keys(E).map(e=>[e,B]),["AllianceLevel",de.XPRequired.length]]),A=Object.fromEntries([...Object.keys(_).map(e=>[e,0]),...Object.keys(T).map(e=>[e,0]),...Object.entries(E).map(([e,a])=>[e,te(a)]),["AllianceLevel",0]]),{data:l,levelMap:R,setTechLevel:j}=ee(),{t:d}=q(),U=d("HS_COMPENDIUM"),m=O(!1),p=O(!1),t=S({size:D.SMALL,title:d("TECHNOLOGIES"),data:{value:{},maxLevel:0,minLevel:0,lastAgoUpdate:0,get key(){return this.value.Name}}}),h=S({size:D.LARGE,title:d("TECHNOLOGIES"),data:{data:f(()=>t.data.value),iconDir:f(()=>b(t.data.value)),tableOpts:f(ne)}}),H=setInterval(v,5e3);F(()=>{clearTimeout(H)});function V(e){l.value&&(t.data.value=e,t.data.maxLevel=P[e.Name],t.data.minLevel=A[e.Name],m.value=!0,v())}function w(e){var a;return!((a=c(e))!=null&&a.level)}function G(e){const a=C(t.data.key);return l.value[a]||(l.value[a]={level:0}),t.data.minLevel!=0&&e==t.data.minLevel&&l.value[a].level!=0&&(e=0),l.value[a].level!=e&&(l.value[a].level=e,j(a,e),v()),e}function c(e){var a;return((a=l.value)==null?void 0:a[C(e)])||null}function z(){var i;const e=t.data.value,a=b(e);if(e.Icon)return L(I,{name:e.Icon,dir:a});if(e.Model)return L(I,{name:e.Model[((i=c(e.Name))==null?void 0:i.level)-1||5],dir:a});if(e.PrefabModel)return L(I,{name:e.PrefabModel,dir:a})}function b(e){if(e.Icon)return e.specialIcon?"icons":"game/Modules";if(e.Model)return"game/Ships";if(e.PrefabModel)return"game/SpaceBuildings"}function v(){var e;if(m.value){const a=(e=c(t.data.key))==null?void 0:e.ts;a&&(t.data.lastAgoUpdate=(new Date().getTime()-a)/1e3)}}return(e,a)=>{const i=X("t");return Z(),K(le,null,{default:u(()=>[o(r(J),null,{default:u(()=>[n("title",null,g(r(U)),1)]),_:1}),n("div",null,[n("div",me,[o(oe,{"on-click":V,"is-muted":w,"level-map":r(R)},null,8,["level-map"])]),o(k,y({open:m.value,"onUpdate:open":a[1]||(a[1]=s=>m.value=s)},t),{body:u(()=>{var s;return[n("div",ce,[n("div",ue,[n("div",null,[n("h2",null,g(e.$t(t.data.value.TID)),1),n("p",null,g(r(d)("TID_SOCIAL_TIMESTAMP",[r(ae)(t.data.lastAgoUpdate)])),1),N(n("button",{class:"button accent",onClick:a[0]||(a[0]=ge=>p.value=!0)},null,512),[[i,"TID_MORE_INFO_BTN"]]),a[3]||(a[3]=n("div",null,null,-1))]),o(z)]),N(n("span",null,null,512),[[i,"CURRENT_LVL"]]),n("div",pe,[o(se,{value:((s=c(t.data.key))==null?void 0:s.level)||0,min:t.data.minLevel,max:t.data.maxLevel,"onUpdate:value":G},null,8,["value","min","max"])])])]}),_:1},16,["open"]),o(k,y({open:p.value,"onUpdate:open":a[2]||(a[2]=s=>p.value=s)},h),{body:u(()=>[o(ie,Q(W(h.data)),null,16)]),_:1},16,["open"])])]),_:1})}}}),Ee=Y(ve,[["__scopeId","data-v-cfd2a4c9"]]);export{Ee as default};
