import{d as ae,g as le,i as h,j as se,S as R,z as oe,G as ne,A as ue,o as n,b as u,f as l,e as _,u as i,t as v,L as ce,h as x,I as ie,F as f,C as y,m as re,M as w,w as $,y as de,D as me,r as pe,B as N,O as ve,s as fe,v as _e,p as ye,_ as Ce}from"./index-TrKe4KmE.js";import{m as V,g as Le,a as Se}from"./ModulePage.vue_vue_type_script_setup_true_lang-sUW3s-Xb.js";import{C as be}from"./Calculator-ANViApuH.js";import{T as ge}from"./TechList-BrlxUwJn.js";import{N as he}from"./NumberPicker-CzJTdTVo.js";import{c as ke}from"./compendiumTechList-km6lt_LV.js";import{g as Te,s as Ie}from"./globals-D0lvPSen.js";import{b as Me}from"./byTypes-DiOuyN-I.js";import{o as z}from"./Data-CxyvaxbL.js";import"./Page-CPc12a0v.js";import"./MultiConfigGUI-CqFXdSl3.js";import"./capital_ships-BOrq68-Q.js";import"./spacebuildings-CVaBZ2bu.js";import"./sec2str-CroEjn0Z.js";const Ne=S=>(fe("data-v-bc97d9b1"),S=S(),_e(),S),Ee={class:"container"},Ue={class:"comp-btn"},Ae={class:"tech-list-wrap"},Oe={class:"modal-module"},De={class:"title"},Pe={class:"reset-buttons"},je={class:"chars"},Be={class:"level-picker"},Re=Ne(()=>l("li",null,[l("br")],-1)),xe={key:0},we={class:"select"},$e={class:"name"},Ve=["value"],ze=["value"],He=ae({__name:"ModulesCalc",setup(S){const H=["UnlockPrice","UnlockTime"],q={actually:"CURRENT_LVL",plan:"PLAN_LVL"},k=me(),{t:G}=le(),{data:F,levelMap:Y,setTechLevel:K}=ke(),{MaxModuleLevel:C}=Te,X=z(V,{map:([t])=>[t,C]}),Z=z(V,{map:([t,a])=>[t,Le(a)]}),J=h({}),d=h({actually:{},plan:{}}),b=h(!1),T=h(!1),s=se({size:R.SMALL,title:G("TID_TECH_DLG_TITLE"),data:{module:{},minLevel:0,maxLevel:0,get key(){return this.module.Name}}});let o;oe(async()=>{await ne()}),ue([Y,()=>k.state.userSettings.compendiumTechSyncConfigIndex],([t])=>{k.state.userSettings.compendiumTechSyncConfigIndex==o.Config.selected&&(d.value.actually={...t},d.value.plan={...t,...d.value.plan})});function Q(t){o=t;for(const a of Me.artifact)J.value[a]=t.provideGetterElements((...r)=>te.apply(null,[a,...r]))}function g(t,a){if(k.state.userSettings.compendiumTechSyncConfigIndex==o.Config.selected&&t=="actually"){const r=ye(s.data.key);K(r,a)}return o.onChangeLvl(t,s.data.key,a)}async function E(t){b.value&&(t.target.name=="all"&&g("actually",0),g("plan",0))}function I(t,a){return o.outputClasses(t,s.data.key,a)}function W(t){s.data.module=t,s.data.maxLevel=X[t.Name],s.data.minLevel=Z[t.Name],b.value=!0}function ee(t,a){const r=a.total;return r.result.ReqBank=0,function(e,m){const p=t[e].UnlockPrice,c=Array.isArray(p)?p[m.plan[e]-1]:p;r.result.ReqBank=c>r.result.ReqBank?c:r.result.ReqBank}}function te(t,...[a,r]){const e=structuredClone(Se(t));return Object.entries(e).map(([m,p])=>{for(const[,c]of Object.entries(p))Array.isArray(c)&&c.length<C&&c.unshift(...Array(C-c.length).fill(0));return r[m]=a(e[m],C),[p,C]})}return(t,a)=>{const r=pe("t");return n(),u("div",null,[l("div",Ee,[_(be,{input:d.value,"onUpdate:input":a[0]||(a[0]=e=>d.value=e),"stack-chars":H,"calc-total":ee,"local-storage-key":"modulesCalc","title-key":"MODULES_CALC",onSetup:Q},null,8,["input"]),l("div",Ue,[i(F)?(n(),u("button",{key:0,class:"button accent",onClick:a[1]||(a[1]=e=>T.value=!0)},v(t.$t("HS_COMPENDIUM")),1)):ce("",!0)]),l("div",Ae,[_(ge,{"on-click":W,"level-map":d.value.actually,"level-map-alt":d.value.plan,"is-muted":e=>!d.value.plan[e]},null,8,["level-map","level-map-alt","is-muted"])])]),_(w,re({open:b.value,"onUpdate:open":a[2]||(a[2]=e=>b.value=e)},s),{body:x(()=>[l("div",Oe,[l("div",De,[l("div",null,[l("h2",null,v(t.$t(s.data.module.TID)),1),l("div",Pe,[l("button",{name:"plan",class:"button yellow",onClick:E},v(t.$t("RESET_PLAN")),1),l("button",{name:"all",class:"button red",onClick:E},v(t.$t("RESET_ALL")),1)])]),_(ie,{name:s.data.module.Icon,dir:"game/Modules"},null,8,["name"])]),l("ul",je,[(n(!0),u(f,null,y(Object.keys(d.value),e=>(n(),u("li",{key:e,class:"input"},[$(l("span",null,null,512),[[r,q[e]]]),l("div",Be,[_(he,{value:d.value[e][s.data.key]||0,min:s.data.minLevel,max:s.data.maxLevel,"onUpdate:value":m=>g(e,m)},null,8,["value","min","max","onUpdate:value"])])]))),128)),Re,(n(!0),u(f,null,y(Object.keys(i(o).output.plan[s.data.key]||{}),e=>{var m,p;return n(),u("li",{key:e,class:N({output:!0,"sub-chars":typeof((p=(m=i(o).output.plan)==null?void 0:m[s.data.key])==null?void 0:p[e])=="object"})},[l("b",null,v(i(o).format.key(e)),1),l("div",null,[(n(!0),u(f,null,y(Object.keys(d.value),c=>{var U,A,O,D;return n(),u("span",{key:c,class:N({...I(c,e),[i(Ie)(e)]:!0,"stats-style":c=="actually"?!I(c,e).none:!1})},[typeof((A=(U=i(o).output[c])==null?void 0:U[s.data.key])==null?void 0:A[e])=="object"?(n(),u("ul",xe,[(n(!0),u(f,null,y(Object.keys(i(o).output[c][s.data.key][e]||{}),L=>(n(),u("li",{key:L,class:"output"},[l("b",null,v(i(o).format.key(L)),1),l("div",null,[(n(!0),u(f,null,y(Object.keys(d.value),M=>{var P,j,B;return n(),u("span",{key:M,class:N(I(M,L))},v(i(o).format.value(L,(B=(j=(P=i(o).output[M])==null?void 0:P[s.data.key])==null?void 0:j[e])==null?void 0:B[L])),3)}),128))])]))),128))])):(n(),u(f,{key:1},[ve(v(i(o).format.value(e,(D=(O=i(o).output[c])==null?void 0:O[s.data.key])==null?void 0:D[e])),1)],64))],2)}),128))])],2)}),128))])])]),_:1},16,["open"]),_(w,{open:T.value,"onUpdate:open":a[4]||(a[4]=e=>T.value=e),size:i(R).SMALL,title:t.$t("HS_COMPENDIUM")},{body:x(()=>[l("div",we,[$(l("p",$e,null,512),[[r,"SYNC"]]),l("select",{value:t.$store.state.userSettings.compendiumTechSyncConfigIndex,onChange:a[3]||(a[3]=e=>t.$store.commit(i(de).SET_COMPENDIUM_TECH_SYNC_CONFIG_INDEX,parseInt(e.target.value)))},[(n(!0),u(f,null,y(i(o).Config.configs,(e,m)=>(n(),u("option",{key:m,value:m},v(e.name),9,ze))),128))],40,Ve)])]),_:1},8,["open","size","title"])])}}}),st=Ce(He,[["__scopeId","data-v-bc97d9b1"]]);export{st as default};
