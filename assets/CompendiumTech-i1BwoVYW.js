import{d as q,g as F,i as O,j as D,a as g,k as K,c as X,h as u,S as C,l as k,r as Z,o as J,e as s,f as n,u as r,H as Q,t as _,M as y,m as N,w as E,n as W,p as Y,q as I,I as L,s as ee,v as ae,_ as te}from"./index-csjiyxTj.js";import{c as ne}from"./compendiumTechList-XPF6ir9Z.js";import{s as oe}from"./sec2str-CD_piKBV.js";import{m as x,g as se,t as le}from"./ModulePage.vue_vue_type_script_setup_true_lang-zJznOo89.js";import{C as ie}from"./CompendiumPage-CDIr2Nmi.js";import{T as re}from"./TechList-ocJ1QzuJ.js";import{N as ce}from"./NumberPicker-Yd-IYGn7.js";import{V as de}from"./Data-Bg-2pisp.js";import{g as me}from"./globals-D0lvPSen.js";import{s as h}from"./capital_ships-BOrq68-Q.js";import{a as pe}from"./alliance_levels-B_mmXvbC.js";import{s as B}from"./spacebuildings-CVaBZ2bu.js";import"./Page-BdI75a8n.js";import"./byTypes-DiOuyN-I.js";const ue=c=>(ee("data-v-cfd2a4c9"),c=c(),ae(),c),ve={class:"container"},fe={class:"modal"},ge={class:"title"},_e=ue(()=>n("div",null,null,-1)),Ie={class:"level-picker"},Le=q({__name:"CompendiumTech",setup(c){const M={RedStarScanner:B.RedStarScanner,ShipmentRelay:B.ShipmentRelay},T={Transport:h.Transport,Miner:h.Miner,Battleship:h.Battleship},{MaxModuleLevel:P}=me,A=Object.fromEntries([...Object.entries(M).map(([e,a])=>[e,a.Cost.length]),...Object.entries(T).map(([e,a])=>[e,a.BuildCost.length]),...Object.keys(x).map(e=>[e,P]),["AllianceLevel",pe.XPRequired.length]]),R=Object.fromEntries([...Object.keys(M).map(e=>[e,0]),...Object.keys(T).map(e=>[e,0]),...Object.entries(x).map(([e,a])=>[e,se(a)]),["AllianceLevel",0]]),{data:o,levelMap:j,setTechLevel:U}=ne(),{t:d}=F(),w=d("HS_COMPENDIUM"),m=O(!1),v=O(!1),t=D({size:C.SMALL,title:d("TECHNOLOGIES"),data:{value:{},maxLevel:0,minLevel:0,lastAgoUpdate:0,get key(){return this.value.Name}}}),S=D({size:C.LARGE,title:d("TECHNOLOGIES"),data:{data:g(()=>t.data.value),iconDir:g(()=>b(t.data.value)),tableOpts:g(le)}}),H=setInterval(f,5e3);K(()=>{clearTimeout(H)});function V(e){o.value&&(t.data.value=e,t.data.maxLevel=A[e.Name],t.data.minLevel=R[e.Name],m.value=!0,f())}function G(e){var a;return!((a=p(e))!=null&&a.level)}function z(e){const a=k(t.data.key);return o.value[a]||(o.value[a]={level:0}),t.data.minLevel!=0&&e==t.data.minLevel&&o.value[a].level!=0&&(e=0),o.value[a].level!=e&&(o.value[a].level=e,U(a,e),f()),e}function p(e){var a;return((a=o.value)==null?void 0:a[k(e)])||null}function $(){var i;const e=t.data.value,a=b(e);if(e.Icon)return I(L,{name:e.Icon,dir:a});if(e.Model)return I(L,{name:e.Model[((i=p(e.Name))==null?void 0:i.level)-1||5],dir:a});if(e.PrefabModel)return I(L,{name:e.PrefabModel,dir:a})}function b(e){if(e.Icon)return e.specialIcon?"icons":"game/Modules";if(e.Model)return"game/Ships";if(e.PrefabModel)return"game/SpaceBuildings"}function f(){var e;if(m.value){const a=(e=p(t.data.key))==null?void 0:e.ts;a&&(t.data.lastAgoUpdate=(new Date().getTime()-a)/1e3)}}return(e,a)=>{const i=Z("t");return J(),X(ie,null,{default:u(()=>[s(r(Q),null,{default:u(()=>[n("title",null,_(r(w)),1)]),_:1}),n("div",null,[n("div",ve,[s(re,{"on-click":V,"is-muted":G,"level-map":r(j)},null,8,["level-map"])]),s(y,N({open:m.value,"onUpdate:open":a[1]||(a[1]=l=>m.value=l)},t),{body:u(()=>{var l;return[n("div",fe,[n("div",ge,[n("div",null,[n("h2",null,_(e.$t(t.data.value.TID)),1),n("p",null,_(r(d)("TID_SOCIAL_TIMESTAMP",[r(oe)(t.data.lastAgoUpdate)])),1),E(n("button",{class:"button accent",onClick:a[0]||(a[0]=he=>v.value=!0)},null,512),[[i,"TID_MORE_INFO_BTN"]]),_e]),s($)]),E(n("span",null,null,512),[[i,"CURRENT_LVL"]]),n("div",Ie,[s(ce,{value:((l=p(t.data.key))==null?void 0:l.level)||0,min:t.data.minLevel,max:t.data.maxLevel,"onUpdate:value":z},null,8,["value","min","max"])])])]}),_:1},16,["open"]),s(y,N({open:v.value,"onUpdate:open":a[2]||(a[2]=l=>v.value=l)},S),{body:u(()=>[s(de,W(Y(S.data)),null,16)]),_:1},16,["open"])])]),_:1})}}}),Ae=te(Le,[["__scopeId","data-v-cfd2a4c9"]]);export{Ae as default};
