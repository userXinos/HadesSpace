"use strict";(self["webpackChunkhades_space"]=self["webpackChunkhades_space"]||[]).push([[622],{8622:(e,t,n)=>{n.d(t,{Z:()=>V});var l=n(66252),o=n(2262),s=n(3577),a=n(49963),i=n(70131),r=n(37928),c=n(77451),u=n(76068),p=n(50930),d=n(53269),f=n(76216),g=n(16798),y=n(51578),h=n(78642),v=n(96124);function _(e,t){const n=(0,o.qj)({actually:{},plan:{},total:{intermediate:{},result:{}}}),l={};for(const o of e)n.total.result[o]=0;const s=t(l,n);return{provideGetterElements:a,output:n,update:i};function a(e){return e(f,l)}function i(t,l){const o=(e,n)=>r(e,(([l],o,s)=>p(Object.fromEntries(s),l,t.actually[e],n))),a=(e,t)=>r(e,(([,e])=>Array.isArray(e)?e[t-1]:e));l?(c(n.plan,l,o(l,t.plan[l])),c(n.actually,l,a(l,t.actually[l]))):(u(t.plan,n.plan,o),u(t.actually,n.actually,a)),d(n.total);for(const[i,r]of Object.entries(n.plan))if(Object.keys(r).length){for(const t of e)n.total.result[t]+=r[t];s(i,t)}}function r(e,t){return(...n)=>{const[[o]]=n;if(m(l[e][o])){const n=(0,h.Z)(l[e][o],{map:(...e)=>[e[0][0],t(...e)]});return[o,n]}const s=t(...n);return[o,s]}}function c(e,t,n){l[t]&&(e[t]=(0,h.Z)(l[t],{map:n}))}function u(e,t,n){if(Object.keys(e).length)for(const[l,o]of Object.entries(e))o?c(t,l,n(l,o)):t[l]={};else for(const l of Object.keys(t))delete t[l]}function p(t,n,l,o){const s=t[n],a=l>0?s[l-1]:0;let i=s[o-1];if(!Array.isArray(s))return!l&&o?s:0;if(e.includes(n)){i=0;let e=l>0?l-1:0;while(e<=o-1)i+=s[e],e++}return i-a}function d(e){for(const t in e)if(t in e){if(m(e[t])){d(e[t]);continue}e[t]=0}}function f(t,n){const l=w(t);return o(l),l;function o(t){for(const l in t)if(l in t){const o=t[l],s="boolean"==typeof o[1]?o[0]:o;if(m(s)){const e=f(s,n);Object.keys(e).length?t[l]=e:delete t[l];continue}if((!Array.isArray(s)||s.length!=n)&&!e.includes(l)){delete t[l];continue}"boolean"==typeof o[1]&&(t[l]=s)}return t}}}function m(e){return"object"===typeof e&&!Array.isArray(e)&&null!==e}function w(e){const t=(0,h.Z)(e,{map:([t,n])=>[t,[n,(0,v.Z)(t,e.Name)]],filter:([e,[,t]])=>!e.startsWith("_")&&!(0,v.Z)(e,null,{asMeta:!0,asTitle:!1})&&(!!y.Z.state.userSettings.disableFilters||!t)});if(e.projectile){const{projectile:e}=t;delete t.projectile,t.projectile=e}return t}var b=n(16513);const C={crush:(e,t=50)=>{const n="",l=(e,l)=>{let o=l.length,s="";const a=e=>encodeURI(encodeURIComponent(e)).replace(/%../g,"i").length,i=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t>=56320&&t<=57343||n>=55296&&n<=56319};let r={};for(let n=2;n<t;n++)for(let t=0;t<e.length-n;++t){let l=e.substr(t,n);if(r[l])continue;if(i(l))continue;let o=1;for(let s=e.indexOf(l,t+n);s>=0;++o)s=e.indexOf(l,s+n);o>1&&(r[l]=o)}while(1){for(;o--&&e.includes(l[o]););if(o<0)break;let t,i=l[o],c=0,u=a(i);for(let e in r){let l=r[e],o=(l-1)*a(e)-(l+1)*u;s.length||(o-=a(n)),o<=0?delete r[e]:o>c&&(t=e,c=o)}if(!t)break;e=e.split(t).join(i)+i+t,s=i+s;let p={};for(let n in r){let l=n.split(t).join(i),o=0;for(let t=e.indexOf(l);t>=0;++o)t=e.indexOf(l,t+l.length);o>1&&(p[l]=o)}r=p}return{a:e,b:s}};let o=[];const s="-_.!~*'()";for(let r=127;--r;)(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||s.includes(String.fromCharCode(r)))&&o.push(String.fromCharCode(r));for(let r=32;r<255;++r){let e=String.fromCharCode(r);"\\"==e||o.includes(e)||o.unshift(e)}e=e.replace(new RegExp(n,"g"),""),e=S(e);const a=l(e,o);let i=a.a;return a.b.length&&(i+=n+a.b),i+="_",i},uncrush:e=>{e=e.substring(0,e.length-1);const t=e.split("");let n=t[0];if(t.length>1){let e=t[1];for(let t of e){let e=n.split(t);n=e.join(e.pop())}}return S(n,0)}},S=(e,t=1)=>{const n=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],l=(e,t)=>{let n=new RegExp(`${(t[2]?t[2]:"")+t[0]}|${(t[3]?t[3]:"")+t[1]}`,"g");return e.replace(n,(e=>e===t[0]?t[1]:t[0]))};if(t)for(let o=0;o<n.length;++o)e=l(e,n[o]);else for(let o=n.length;o--;)e=l(e,n[o]);return e},k="new entry",E="en";class O{localStoreKey;store;TIDs={};constructor(e){this.localStoreKey=e,this.store=(0,o.qj)({configs:[],selected:0}),this.load()}get selectedConfig(){return this.store.configs[this.store.selected].value}load(){const e=JSON.parse(localStorage.getItem(this.localStoreKey)||"{}");e.configs?Object.assign(this.store,e):Object.keys(e).length&&e.actually&&e.plan?this.add(e):this.add()}save(){localStorage.setItem(this.localStoreKey,JSON.stringify(this.store))}removeSelected(){this.store.configs.splice(this.store.selected,1),0!=this.store.configs.length?this.store.selected=this.store.configs.length-1:this.add()}add(e,{temporary:t}={temporary:!1}){const n=this.store;let l,o=0;do{l=o?`${k} #${o}`:k,o++}while(n.configs.length&&n.configs.some((e=>e.name==l)));n.configs=[...n.configs,{name:l,value:e||{actually:{},plan:{}}}],n.selected=n.configs.length-1,t||this.save()}async parseString(e){const t=[];b["default"].global.availableLocales.includes(E)||await(0,b.J)(E);for(const[n,l]of Object.entries(this.TIDs)){const o=b["default"].global.t(l,E),s=new RegExp(`${o}\\s+?(\\d+)\\s?`,"mi"),[,a]=e.match(s)||[void 0,"0"];t.push([n,parseInt(a)])}return Object.fromEntries(t.filter((([,e])=>e)))}stringifyUrl(){const e=JSON.stringify(this.selectedConfig.actually);return C.crush(e)}parseUrl(e){return JSON.parse(C.uncrush(e))}}const U=e=>((0,l.dD)("data-v-dd4d13c4"),e=e(),(0,l.Cn)(),e),T={class:"topic"},A={class:"total-table"},D={key:0,colspan:"3"},I={class:"buttons"},j={class:"reset-buttons"},Z={class:"settings-modal"},R={class:"config-category"},x={class:"flex-end"},z={class:"select"},L={class:"name"},$=["value"],K={class:"input"},N={class:"name"},H=["placeholder"],M={class:"flex-end margin-bottom"},F={class:"input"},G={class:"name"},P=U((()=>(0,l._)("p",{class:"name"},"Example: Fortify 8 Bond 5",-1))),Y={class:"flex-end margin-bottom"},q=(0,l.aZ)({__name:"Calculator",props:{stackChars:{},calcTotal:{},localStorageKey:{},titleKey:{},input:{}},emits:["update:input","setup"],setup(e,{emit:t}){const n=e,{t:y}=(0,i.QT)(),h={key:e=>(0,f.Z)(e,r.Z.currentRoute.value.name),value:(e,t)=>(0,d.Z)(e,t,r.Z.currentRoute.value.name)},{provideGetterElements:v,output:m,update:w}=_(n.stackChars,n.calcTotal),b=new O(n.localStorageKey),C={output:m,onChangeLvl:ae,isSelected:ie,isDisabled:re,outputClasses:ce,forceReCalc:ee,format:h,provideGetterElements:e=>v(((...t)=>e(b.TIDs,...t)))};let S=()=>Promise.prototype;const k=(0,o.iH)(!1),E=(0,o.iH)(!1),U=(0,o.iH)(""),q=(0,o.iH)({text:y("COPY"),color:"yellow"}),W=(0,l.Fl)((()=>y(n.titleKey))),J=(0,l.Fl)((()=>Object.keys(m.total.result))),V=(0,l.Fl)((()=>`${location.origin}${location.pathname}`));if(r.Z.currentRoute.value.query.d){const e=b.parseUrl(r.Z.currentRoute.value.query.d),t={actually:{...e},plan:{...e}};b.add(t,{temporary:!0})}function Q(e){S=e}function B(){t("update:input",b.selectedConfig)}function X(e){(0,l.Y3)((()=>w(n.input,e)))}function ee(){B(),X()}async function te(e){if("all"==e.target.name)await S("Reset all ? Are you serious ?").then((()=>{for(const e in n.input)e in n.input&&(b.selectedConfig[e]={})})).catch((()=>{}));else if(n.input.plan)for(const t in n.input.plan)t in n.input.plan&&(b.selectedConfig.plan[t]=n.input.actually[t]);X(),b.save()}async function ne(){const{name:e}=b.store.configs[b.store.selected];await S(y("REMOVE_CONFIG",[e])).then((()=>{b.removeSelected(),ee()})).catch((()=>{}))}async function le(){let e={};U.value&&await b.parseString(U.value).then((t=>e=t)).catch((e=>{alert(e.message),console.error(e)})),b.add({actually:{...e},plan:{...e}}),U.value="",E.value=!1,ee()}function oe(){const e=b.stringifyUrl();navigator.clipboard.writeText(`${V.value}?d=${e}`).then((()=>{q.value={text:y("COPIED"),color:"green"},setTimeout((()=>q.value={text:y("COPY"),color:"yellow"}),2e3)})).catch((e=>{q.value={text:y("Error"),color:"red"},alert(e.message),console.error(e)}))}function se(e,t){const n=m.total.intermediate[t];if("plan"==e)return{"yellow-color plus":n.plan,hide:0==n.plan};if("sum"==e){const e=n.sum>n.actually;return{"green-color ":e,muffle:!e,hide:0==n.sum}}return{}}function ae(e,t,l){return l="string"===typeof l?parseInt(l):l,0==l?(delete n.input[e][t],delete m[e][t]):b.selectedConfig[e][t]=l,B(),X(t),b.save(),l}function ie(e,t,l){let o=n.input.plan[t]||0;const s=n.input.actually[t];return s>o&&(o=ae("plan",t,s)),"plan"==e?l==o:n.input[e][t]==l}function re(e,t,l){return!("plan"!=e||!n.input.actually)&&l<n.input.actually[t]}function ce(e,t,l){if("actually"==e)return{none:l&&J.value.includes(l),actually:!0};if("plan"==e){const o=l?m[e][t][l]:void 0;return{"yellow-color":(!n.input.actually[t]||n.input.plan[t]>n.input.actually[t])&&"object"!==typeof o,plus:!l||l&&!J.value.includes(l),none:n.input.plan[t]==n.input.actually[t],plan:!0}}return{}}return ee(),t("setup",C),(e,t)=>{const n=(0,l.Q2)("t");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)((0,o.SU)(c.Fb),null,{default:(0,l.w5)((()=>[(0,l._)("title",null,(0,s.zw)(W.value),1)])),_:1}),(0,l._)("h1",T,(0,s.zw)(W.value),1),(0,l._)("table",A,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(m).total.intermediate,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",{class:(0,s.C_)([(0,o.SU)(g.Z)(t),"stats-style"])},(0,s.zw)(h.key(t)),3),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e,((e,n)=>((0,l.wg)(),(0,l.iD)("td",{key:t+n,class:(0,s.C_)(se(n,t))},(0,s.zw)(e.toLocaleString("ru-RU")),3)))),128))])))),128)),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(m).total.result,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t,class:"result"},[(0,l._)("td",{class:(0,s.C_)([(0,o.SU)(g.Z)(t),"stats-style"])},(0,s.zw)(h.key(t)),3),e>0?((0,l.wg)(),(0,l.iD)("td",D,[(0,l._)("b",null,(0,s.zw)(h.value(t,e)),1)])):(0,l.kq)("",!0)])))),128))]),(0,l._)("div",I,[(0,l._)("button",{class:"settings",onClick:t[0]||(t[0]=e=>k.value=!0)}),(0,l._)("div",j,[(0,l._)("button",{class:"button yellow",name:"plan",onClick:te},(0,s.zw)(e.$t("RESET_PLAN")),1),(0,l._)("button",{class:"button red",name:"all",onClick:te},(0,s.zw)(e.$t("RESET_ALL")),1)])]),(0,l.Wm)(p.Z,{open:k.value,"onUpdate:open":[t[5]||(t[5]=e=>k.value=e),t[6]||(t[6]=()=>(0,o.SU)(b).save())],title:e.$t("CALCULATOR_SETTINGS"),size:(0,o.SU)(p.z).MEDIUM},{body:(0,l.w5)((()=>[(0,l._)("div",Z,[(0,l._)("div",R,[(0,l.wy)((0,l._)("p",null,null,512),[[n,"CONFIG"]]),(0,l._)("div",x,[(0,l._)("button",{class:(0,s.C_)(`button ${q.value.color}`),onClick:oe},(0,s.zw)(q.value.text),3),(0,l.wy)((0,l._)("button",{class:"button green",onClick:t[1]||(t[1]=e=>E.value=!0)},null,512),[[n,"CREATE"]])])]),(0,l._)("div",z,[(0,l.wy)((0,l._)("p",L,null,512),[[n,"LIST"]]),(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.SU)(b).store.selected=e),onChange:t[3]||(t[3]=e=>ee())},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(b).store.configs,((e,t)=>((0,l.wg)(),(0,l.iD)("option",{key:t,value:t},(0,s.zw)(e.name),9,$)))),128))],544),[[a.bM,(0,o.SU)(b).store.selected]])]),(0,l._)("div",K,[(0,l.wy)((0,l._)("p",N,null,512),[[n,"TID_CHANGE_NAME_TITLE"]]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>(0,o.SU)(b).store.configs[(0,o.SU)(b).store.selected].name=e),placeholder:e.$t("TID_CORP_NAME_LABEL")},null,8,H),[[a.nr,(0,o.SU)(b).store.configs[(0,o.SU)(b).store.selected].name]])]),(0,l._)("div",M,[(0,l.wy)((0,l._)("button",{class:"button red",onClick:ne},null,512),[[n,"TID_SOCIAL_DELETE_MESSAGE"]])])])])),_:1},8,["open","title","size"]),(0,l.Wm)(u.Z,{onSetShow:Q}),(0,l.Wm)(p.Z,{open:E.value,"onUpdate:open":t[8]||(t[8]=e=>E.value=e),title:e.$t("CREATE"),size:(0,o.SU)(p.z).SMALL},{body:(0,l.w5)((()=>[(0,l._)("div",F,[(0,l.wy)((0,l._)("p",G,null,512),[[n,"FROM_TEXT_FORMAT"]]),P,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>U.value=e)},null,512),[[a.nr,U.value]])]),(0,l._)("div",Y,[(0,l.wy)((0,l._)("button",{class:"button green",onClick:le},null,512),[[n,"TID_OK"]])])])),_:1},8,["open","title","size"])])}}});var W=n(83744);const J=(0,W.Z)(q,[["__scopeId","data-v-dd4d13c4"]]),V=J},76068:(e,t,n)=>{n.d(t,{Z:()=>g});var l=n(66252),o=n(49963),s=n(3577),a=n(2262),i=n(50930);const r={class:"wrap"},c={key:0,class:"container"},u={class:"buttons"},p=(0,l.aZ)({__name:"TheConfirm",emits:["setShow"],setup(e,{emit:t}){const n=(0,a.iH)(""),p=(0,a.iH)(!1);let d,f;function g(){h(f)}function y(e){return p.value=!0,n.value=e,new Promise(((e,t)=>{d=e,f=t}))}function h(e){e(),p.value=!1,d=()=>null,f=()=>null}return t("setShow",y),(e,t)=>{const y=(0,l.Q2)("t");return(0,l.wg)(),(0,l.j4)(i.Z,{title:"Confirm",open:p.value,"onUpdate:open":g},{default:(0,l.w5)((()=>[(0,l.Wm)(o.uT,null,{default:(0,l.w5)((()=>[(0,l._)("div",r,[p.value?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Uk)((0,s.zw)(n.value)+" ",1),(0,l._)("div",u,[(0,l.wy)((0,l._)("button",{onClick:t[0]||(t[0]=e=>h((0,a.SU)(f)))},null,512),[[y,"TID_CANCEL"]]),(0,l.wy)((0,l._)("button",{onClick:t[1]||(t[1]=e=>h((0,a.SU)(d)))},null,512),[[y,"TID_OK"]])])])):(0,l.kq)("",!0)])])),_:1})])),_:1},8,["open"])}}});var d=n(83744);const f=(0,d.Z)(p,[["__scopeId","data-v-7b674cbe"]]),g=f}}]);